(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d3b468e"],{"0676":function(t,e){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}t.exports=n},1196:function(t,e,n){"use strict";var m=n("f2f7"),s=n.n(m);s.a},"11b0":function(t,e){function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}t.exports=n},2236:function(t,e){function n(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}t.exports=n},"448a":function(t,e,n){var m=n("2236"),s=n("11b0"),o=n("0676");function a(t){return m(t)||s(t)||o()}t.exports=a},bb3c:function(t,e,n){"use strict";n.r(e);var m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"page-frame"},[n("div",{staticClass:"text-h6 q-py-md"},[t._v("\n    "+t._s(t.meme.title)+"\n  ")]),n("div",{staticClass:"row justify-center q-col-gutter-md"},[n("div",{staticClass:"col-12 col-sm-6 column justify-start"},[n("q-img",{staticClass:"q-mb-sm",attrs:{"spinner-color":"primary",src:t.meme.cloudinaryUrl,alt:t.meme.title}}),n("meme-metadata",{attrs:{username:t.meme.username,"date-created":t.meme.dateCreated}}),n("div",{staticClass:"row justify-between"},[n("vote-buttons",{staticClass:"q-mb-sm q-mr-sm",attrs:{"meme-id":t.memeId,"up-votes":t.meme.upVotes,"down-votes":t.meme.downVotes,"user-vote":t.meme.userVote}}),n("div",{staticClass:"row items-center self-stretch q-mb-sm"},[n("q-icon",{attrs:{name:"comment",left:"",size:"24px"}}),n("div",{staticClass:"text-subtitle2"},[t._v("\n            "+t._s(t.meme.commentCount||0)+"\n          ")])],1)],1)],1),n("div",{staticClass:"col-12 col-sm-6 column justify-start"},[t.loggedIn?n("form",{staticClass:"row q-mb-md",on:{submit:function(e){return e.preventDefault(),t.addComment(e)}}},[n("q-input",{staticClass:"col-grow",attrs:{outlined:"",placeholder:"Write a comment..."},scopedSlots:t._u([{key:"append",fn:function(){return[n("q-btn",{attrs:{type:"submit",round:"",flat:"",icon:"send",color:t.draftComment?"primary":void 0,disable:!t.draftComment}})]},proxy:!0}],null,!1,1016970661),model:{value:t.draftComment,callback:function(e){t.draftComment=e},expression:"draftComment"}})],1):t._e(),n("q-infinite-scroll",{attrs:{offset:250,disable:!t.earlierComments},on:{load:t.loadOlderComments},scopedSlots:t._u([{key:"loading",fn:function(){return[n("div",{staticClass:"row justify-center q-my-md"},[n("q-spinner",{attrs:{color:"primary",size:"40px"}})],1)]},proxy:!0}])},t._l(t.sortedComments,function(e){return n("comment-card",t._b({key:e.commentId},"comment-card",e,!1))}),1)],1)])])},s=[],o=n("448a"),a=n.n(o),r=(n("55dd"),n("3156")),i=n.n(r),c=(n("c5f6"),n("2f62")),u=n("b747"),d=n.n(u),l=n("0072"),f=n("e43f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"q-mb-sm"},[n("q-card",[n("q-card-section",[n("meme-metadata",{staticClass:"comment-metadata",attrs:{username:t.username,"date-created":t.dateCreated}}),n("div",{staticClass:"text-body1"},[t._v("\n        "+t._s(t.text)+"\n      ")])],1)],1)],1)},C=[],h={name:"CommentCard",components:{"meme-metadata":f["a"]},props:{commentId:{type:Number,default:-1},username:{type:String,default:""},dateCreated:{type:String,default:""},text:{type:String,default:""}}},v=h,b=(n("1196"),n("2877")),y=Object(b["a"])(v,p,C,!1,null,null,null),g=y.exports,q={name:"PageMeme",components:{"vote-buttons":l["a"],"meme-metadata":f["a"],"comment-card":g},props:{memeId:{type:Number,default:-1}},data:function(){return{meme:{title:"",cloudinaryUrl:"",username:"",dateCreated:"",upVotes:0,downVotes:0,userVote:null,commentCount:0},draftComment:"",comments:[],earlierComments:!0}},computed:i()({},Object(c["b"])(["loggedIn"]),{slugTitle:function(){return d()(this.title,{remove:/[*+~,.()'"!:@]/g})},sortedComments:function(){return this.comments.slice().sort(function(t,e){return t.commentId<e.commentId})},earliestComment:function(){return this.comments.length?this.comments.reduce(function(t,e){return Math.min(t,e.commentId)},1/0):0}}),watch:{loggedIn:function(){this.$forceUpdate(),this.$socket.emit("getMeme",this.memeId)}},mounted:function(){this.$socket.emit("getMeme",this.memeId)},beforeDestroy:function(){this.$socket.emit("leaveMeme",this.meme.memeId)},methods:{addComment:function(){this.draftComment&&this.$socket.emit("addComment",{memeId:this.memeId,text:this.draftComment})},loadOlderComments:function(t,e){var n=this;this.$socket.emit("getMemeComments",this.memeId,this.earliestComment,function(t){t.isSuccessful?t.value.length?n.comments=n.comments.concat(t.value):n.earlierComments=!1:n.$q.notify(t.value),e()})}},sockets:{getMeme:function(t){t.isSuccessful?this.meme=i()({},this.meme,t.value):this.$q.notify(t.value)},addComment:function(t){t.isSuccessful?this.draftComment="":this.$q.notify(t.value)},newLiveComment:function(t){t.memeId===this.meme.memeId&&(this.comments=[t].concat(a()(this.comments)),this.meme.commentCount+=1)}}},w=q,I=Object(b["a"])(w,m,s,!1,null,null,null);e["default"]=I.exports},f2f7:function(t,e,n){}}]);